<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>è¯»marked.jsæºç  -- markdownæ˜¯æ€ä¹ˆå˜æˆhtmlçš„ | ä¸ªäººä¸»é¡µ</title>
    <meta name="description" content="ä¸€ä¸ªäº’è”ç½‘å…¨æ‰å¦¹å­ï¼Œä¼šè®¾è®¡ï¼Œä¼šå‰ç«¯ï¼Œä¼šåç«¯ï¼Œè¿˜ä¼šè§†é¢‘åŠ¨æ•ˆï¼Œå¥½åƒå¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚">
    
    
    <link rel="preload" href="/blog/assets/css/styles.b8f6f876.css" as="style"><link rel="preload" href="/blog/assets/js/app.b8f6f876.js" as="script"><link rel="preload" href="/blog/assets/js/24.cc9b4c20.js" as="script"><link rel="prefetch" href="/blog/assets/css/1.styles.8e8fe409.css"><link rel="prefetch" href="/blog/assets/css/2.styles.a2bd3099.css"><link rel="prefetch" href="/blog/assets/js/1.8e8fe409.js"><link rel="prefetch" href="/blog/assets/js/10.619c7997.js"><link rel="prefetch" href="/blog/assets/js/11.9c3e970b.js"><link rel="prefetch" href="/blog/assets/js/12.531cd467.js"><link rel="prefetch" href="/blog/assets/js/13.7e326423.js"><link rel="prefetch" href="/blog/assets/js/14.f3b097e0.js"><link rel="prefetch" href="/blog/assets/js/15.6a2e75f0.js"><link rel="prefetch" href="/blog/assets/js/16.c206d890.js"><link rel="prefetch" href="/blog/assets/js/17.cff55b68.js"><link rel="prefetch" href="/blog/assets/js/18.cbfbf9aa.js"><link rel="prefetch" href="/blog/assets/js/19.96969ef1.js"><link rel="prefetch" href="/blog/assets/js/2.a2bd3099.js"><link rel="prefetch" href="/blog/assets/js/20.357307bb.js"><link rel="prefetch" href="/blog/assets/js/21.69c3455f.js"><link rel="prefetch" href="/blog/assets/js/22.4efd32d6.js"><link rel="prefetch" href="/blog/assets/js/23.f297491c.js"><link rel="prefetch" href="/blog/assets/js/25.ee8d1b0e.js"><link rel="prefetch" href="/blog/assets/js/26.762d7fbf.js"><link rel="prefetch" href="/blog/assets/js/27.3a122b7f.js"><link rel="prefetch" href="/blog/assets/js/28.2175adc1.js"><link rel="prefetch" href="/blog/assets/js/29.ebb9d56c.js"><link rel="prefetch" href="/blog/assets/js/3.7e0f7a9a.js"><link rel="prefetch" href="/blog/assets/js/30.73a02a6b.js"><link rel="prefetch" href="/blog/assets/js/31.1eae61bd.js"><link rel="prefetch" href="/blog/assets/js/32.c07b58b2.js"><link rel="prefetch" href="/blog/assets/js/33.397eaa54.js"><link rel="prefetch" href="/blog/assets/js/34.51ce988a.js"><link rel="prefetch" href="/blog/assets/js/35.58456503.js"><link rel="prefetch" href="/blog/assets/js/36.608991b7.js"><link rel="prefetch" href="/blog/assets/js/4.66ec0ecb.js"><link rel="prefetch" href="/blog/assets/js/5.38cc5d58.js"><link rel="prefetch" href="/blog/assets/js/6.ce65520e.js"><link rel="prefetch" href="/blog/assets/js/7.705c84c4.js"><link rel="prefetch" href="/blog/assets/js/8.95f0bebe.js"><link rel="prefetch" href="/blog/assets/js/9.291ac53a.js">
    <link rel="stylesheet" href="/blog/assets/css/1.styles.8e8fe409.css"><link rel="stylesheet" href="/blog/assets/css/2.styles.a2bd3099.css"><link rel="stylesheet" href="/blog/assets/css/styles.b8f6f876.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">ä¸ªäººä¸»é¡µ</span></a> <div class="links" style="max-width:nullpx;"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">ä¸»é¡µ</a></div><div class="nav-item"><a href="/blog/home/" class="nav-link">vueæºç è§£è¯»</a></div><div class="nav-item"><a href="/blog/webpack/" class="nav-link">webpackæºç è§£è¯»</a></div><div class="nav-item"><a href="/blog/node/" class="nav-link">koaæºç è§£æ</a></div><div class="nav-item"><a href="/blog/base/" class="nav-link">JSåŸºç¡€</a></div><div class="nav-item"><a href="/blog/source/" class="nav-link router-link-exact-active router-link-active">å…¶ä»–</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">åšæ–‡</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/interview/" class="nav-link">é¢è¯•é¢˜</a></li><li class="dropdown-item"><!----> <a href="/blog/essay/" class="nav-link">éšæƒ³</a></li><li class="dropdown-item"><!----> <a href="https://saintgirl.zcool.com.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  è®¾è®¡
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Carrie999" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">ä¸»é¡µ</a></div><div class="nav-item"><a href="/blog/home/" class="nav-link">vueæºç è§£è¯»</a></div><div class="nav-item"><a href="/blog/webpack/" class="nav-link">webpackæºç è§£è¯»</a></div><div class="nav-item"><a href="/blog/node/" class="nav-link">koaæºç è§£æ</a></div><div class="nav-item"><a href="/blog/base/" class="nav-link">JSåŸºç¡€</a></div><div class="nav-item"><a href="/blog/source/" class="nav-link router-link-exact-active router-link-active">å…¶ä»–</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">åšæ–‡</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/interview/" class="nav-link">é¢è¯•é¢˜</a></li><li class="dropdown-item"><!----> <a href="/blog/essay/" class="nav-link">éšæƒ³</a></li><li class="dropdown-item"><!----> <a href="https://saintgirl.zcool.com.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  è®¾è®¡
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Carrie999" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>è¯»æºç ,é€ è½®å­</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/source/" class="active sidebar-link">è¯»marked.jsæºç  -- markdownæ˜¯æ€ä¹ˆå˜æˆhtmlçš„</a></li><li><a href="/blog/source/react-beauty-highcharts.html" class="sidebar-link">ç¾åŒ–HighChartsæ’ä»¶  react-beauty-highcharts</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="è¯»marked-jsæºç -markdownæ˜¯æ€ä¹ˆå˜æˆhtmlçš„"><a href="#è¯»marked-jsæºç -markdownæ˜¯æ€ä¹ˆå˜æˆhtmlçš„" aria-hidden="true" class="header-anchor">#</a> è¯»marked.jsæºç  -- markdownæ˜¯æ€ä¹ˆå˜æˆhtmlçš„</h1> <p>å¾ˆå¥½å¥‡markdownæ˜¯æ€ä¹ˆå˜æˆhtmlçš„,å¶ç„¶é—´çœ‹åˆ°
<a href="https://github.com/markedjs/marked" target="_blank" rel="noopener noreferrer">github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ä¸Šçš„è¿™ä¸€ç¯‡æ˜Ÿæ˜Ÿâœ¨å¾ˆé«˜çš„æºç ,å°±æ¥ç ”ç©¶ç ”ç©¶
ä¸‹è½½æ‰“å¼€åœ¨libæ–‡ä»¶å¤¹ä¸‹çš„marked.jså¤§æ¦‚1600è¡Œå·¦å³çš„æ ·å­,æ²¡æœ‰ç»„ä»¶åŒ–,æ‰€æœ‰çš„jséƒ½æ˜¯åœ¨ä¸€ä¸ªé¡µé¢,è¯»ç€å¾ˆæ˜¯é¡ºç•…å“ˆ~(è¿™é‡Œæ²¡æœ‰è´¬ä½å¤šä¸ªæ–‡ä»¶çš„å•Š,ä¸è¦ç”Ÿæ°”,å˜»å˜»ğŸ˜„å…¶å®æ˜¯æœ‰çš„,ä¸€ä¸ªæ–‡ä»¶å°±æ˜¯çœ‹ç€ç®€å•)
åœ¨htmlå¼•å…¥js</p> <div class="language-jsÂ· extra-class"><pre class="language-text"><code> &lt;script src=&quot;./marked.js&quot;&gt;&lt;/script&gt;
</code></pre></div><p>ç„¶ååœ¨jsä¸­å†™ä¸‹</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'content'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span>
    <span class="token function">marked</span><span class="token punctuation">(</span><span class="token string">'# Marked in the browser\n\nRendered by **marked**.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><p>ç¥å¥‡çš„ç°è±¡å‘ç”Ÿäº†é¡µé¢å˜æ¼‚äº®äº†???
é‚£ä¹ˆå°±éšmarkedå‡½æ•°çœ‹ä¸€çœ‹æ˜¯å¦‚ä½•å®ç°çš„å§
é¦–å…ˆæˆ‘ä»¬å®šä½åˆ°1461è¡Œ,çœ‹åˆ°äº†ä¸€ä¸ªæˆ‘ä»¬æ‰€ç†Ÿæ‚‰äº²åˆ‡çš„markedå‡½æ•°,æ¥å—3ä¸ªå‚æ•°,srcæ˜¯markdown, optæ˜¯é…ç½®{}, callbackæ˜¯å›è°ƒ</p> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token comment">// 1461 </span>
<span class="token function">mark</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> opt<span class="token punctuation">,</span> callback<span class="token punctuation">)</span>
<span class="token comment">// 1544</span>
Parser<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>Lexer<span class="token punctuation">.</span><span class="token function">lex</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> opt<span class="token punctuation">)</span><span class="token punctuation">,</span> opt<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// è¿”å›äº†çœŸæ­£çš„å¸¦æœ‰æ ‡ç­¾çš„æ–‡æœ¬,æ‰€ä»¥æ¥ä¸‹æ¥ç ”ç©¶Lexerå¯¹è±¡å’ŒParser.parse</span>
Lexer<span class="token punctuation">.</span><span class="token function">lex</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> opt<span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 163 </span>
Lexer<span class="token punctuation">.</span><span class="token function-variable function">lex</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> lexer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Lexer</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> lexer<span class="token punctuation">.</span><span class="token function">lex</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>Lexer<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">lex</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  src <span class="token operator">=</span> src
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\r\n|\r/g</span><span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\t/g</span><span class="token punctuation">,</span> <span class="token string">'    '</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\u00a0/g</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\u2424/g</span><span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// console.log('178#', src)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'178#'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">token</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">token</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token comment">// {type: &quot;heading&quot;, depth: 1, text: &quot;Marked in the browser&quot;}</span>
  <span class="token comment">// {type: &quot;paragraph&quot;, text: &quot;Rendered by  **marked**.&quot;}</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">token</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>this.token(src, true);è¿”å›æ•°ç»„,æ•°ç»„é•¿åº¦ä¸º3,[0]æ˜¯Marked in the browser,
[1]æ˜¯Rendered by <strong>marked</strong>.å­—æ®µ</p> <p>æˆ‘ä»¬çœ‹185è¡Œ
Lexer.prototype.token
cap = this.rules.heading.exec(src)æˆç«‹</p> <p>[&quot;# Marked in the browserâ†µâ†µ&quot;, &quot;#&quot;, &quot;Marked in the browser&quot;, index: 0, input: &quot;# Marked in the browserâ†µâ†µRendered by <strong>marked</strong>.&quot;, groups: undefined]</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>cap <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>rules<span class="token punctuation">.</span>heading<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  src <span class="token operator">=</span> src<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>cap<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>tokens<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token string">'heading'</span><span class="token punctuation">,</span>
    depth<span class="token punctuation">:</span> cap<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">,</span>
    text<span class="token punctuation">:</span> cap<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">continue</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿½è¸ª</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">this</span><span class="token punctuation">.</span>rules<span class="token punctuation">.</span>heading<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span>
  Lexer<span class="token punctuation">.</span>rules <span class="token operator">=</span> block<span class="token punctuation">;</span>
</code></pre></div><p>inlineæ˜¯ä¸€ä¸ªå¯¹è±¡,åŒ…å«ä¸€æ•´å¥—åŒ¹é…è§„åˆ™</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 14</span>
<span class="token keyword">var</span> block <span class="token operator">=</span> <span class="token punctuation">{</span>
  newline<span class="token punctuation">:</span> <span class="token regex">/^\n+/</span><span class="token punctuation">,</span>
  code<span class="token punctuation">:</span> <span class="token regex">/^( {4}[^\n]+\n*)+/</span><span class="token punctuation">,</span>
  fences<span class="token punctuation">:</span> noop<span class="token punctuation">,</span>
  hr<span class="token punctuation">:</span> <span class="token regex">/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/</span><span class="token punctuation">,</span>
  heading<span class="token punctuation">:</span> <span class="token regex">/^ *(#{1,6}) *([^\n]+?) *(?:#+ *)?(?:\n+|$)/</span><span class="token punctuation">,</span>
  nptable<span class="token punctuation">:</span> noop<span class="token punctuation">,</span>
  blockquote<span class="token punctuation">:</span> <span class="token regex">/^( {0,3}&gt; ?(paragraph|[^\n]*)(?:\n|$))+/</span><span class="token punctuation">,</span>
  list<span class="token punctuation">:</span> <span class="token regex">/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/</span><span class="token punctuation">,</span>
  html<span class="token punctuation">:</span> <span class="token string">'^ {0,3}(?:'</span> <span class="token comment">// optional indentation</span>
    <span class="token operator">+</span> <span class="token string">'&lt;(script|pre|style)[\\s&gt;][\\s\\S]*?(?:&lt;/\\1&gt;[^\\n]*\\n+|$)'</span> <span class="token comment">// (1)</span>
    <span class="token operator">+</span> <span class="token string">'|comment[^\\n]*(\\n+|$)'</span> <span class="token comment">// (2)</span>
    <span class="token operator">+</span> <span class="token string">'|&lt;\\?[\\s\\S]*?\\?&gt;\\n*'</span> <span class="token comment">// (3)</span>
    <span class="token operator">+</span> <span class="token string">'|&lt;![A-Z][\\s\\S]*?&gt;\\n*'</span> <span class="token comment">// (4)</span>
    <span class="token operator">+</span> <span class="token string">'|&lt;!\\[CDATA\\[[\\s\\S]*?\\]\\]&gt;\\n*'</span> <span class="token comment">// (5)</span>
    <span class="token operator">+</span> <span class="token string">'|&lt;/?(tag)(?: +|\\n|/?&gt;)[\\s\\S]*?(?:\\n{2,}|$)'</span> <span class="token comment">// (6)</span>
    <span class="token operator">+</span> <span class="token string">'|&lt;(?!script|pre|style)([a-z][\\w-]*)(?:attribute)*? */?&gt;(?=\\h*\\n)[\\s\\S]*?(?:\\n{2,}|$)'</span> <span class="token comment">// (7) open tag</span>
    <span class="token operator">+</span> <span class="token string">'|&lt;/(?!script|pre|style)[a-z][\\w-]*\\s*&gt;(?=\\h*\\n)[\\s\\S]*?(?:\\n{2,}|$)'</span> <span class="token comment">// (7) closing tag</span>
    <span class="token operator">+</span> <span class="token string">')'</span><span class="token punctuation">,</span>
  def<span class="token punctuation">:</span> <span class="token regex">/^ {0,3}\[(label)\]: *\n? *&lt;?([^\s&gt;]+)&gt;?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/</span><span class="token punctuation">,</span>
  table<span class="token punctuation">:</span> noop<span class="token punctuation">,</span>
  lheading<span class="token punctuation">:</span> <span class="token regex">/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/</span><span class="token punctuation">,</span>
  paragraph<span class="token punctuation">:</span> <span class="token regex">/^([^\n]+(?:\n(?!hr|heading|lheading| {0,3}&gt;|&lt;\/?(?:tag)(?: +|\n|\/?&gt;)|&lt;(?:script|pre|style|!--))[^\n]+)*)/</span><span class="token punctuation">,</span>
  text<span class="token punctuation">:</span> <span class="token regex">/^[^\n]+/</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>æˆ‘ä»¬æ‰¾åˆ°äº† this.rules.headingæ˜¯blocké‡Œçš„heading,é‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯exec
execå°±æ˜¯æ­£åˆ™!æ­£åˆ™!æ­£åˆ™!</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token regex">/^ *(#{1,6}) *([^\n]+?) *(?:#+ *)?(?:\n+|$)/</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">'# Marked in the browser\n\nRendered by **marked**.'</span><span class="token punctuation">)</span>
</code></pre></div><p>æ­£åˆ™åŒ¹é…ç»“æœæ˜¯
æ•°ç»„ [&quot;# Marked in the browserâ†µâ†µ,&quot;#&quot;,&quot;Marked in the browser&quot;]</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 236</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>cap <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>rules<span class="token punctuation">.</span>heading<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// srcæ˜¯å‰©ä¸‹çš„ä¹Ÿå°±è¯´Rendered by **marked**.,å½“srcé•¿åº¦ä¸º0çš„æ—¶å€™,å¾ªç¯ç»“æŸ</span>
  src <span class="token operator">=</span> src<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>cap<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// åˆ¤æ–­ æ˜¯heading </span>
  <span class="token comment">// push type</span>
  <span class="token comment">// depthæ˜¯æ­£åˆ™åŒ¹é…&quot;#&quot;çš„é•¿åº¦</span>
  <span class="token comment">// text æ˜¯åŒ¹é…å‡ºæ¥çš„çš„ç»“æœ</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>tokens<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token string">'heading'</span><span class="token punctuation">,</span>
    depth<span class="token punctuation">:</span> cap<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">,</span>
    text<span class="token punctuation">:</span> cap<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">continue</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ¥ä¸‹æ¥ç»§ç»­è§£æsrc,æˆ‘ä»¬çœ‹åˆ°ç¬¬491è¡Œè¿™é‡Œè¢«è§£æäº†,ä¸Šé¢ç¬¬æ­£åˆ™éƒ½æœªåŒ¹é…æˆåŠŸ</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>top <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>cap <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>rules<span class="token punctuation">.</span>paragraph<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  src <span class="token operator">=</span> src<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>cap<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>tokens<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token string">'paragraph'</span><span class="token punctuation">,</span>
    text<span class="token punctuation">:</span> cap<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>cap<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'\n'</span>
      <span class="token operator">?</span> cap<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token punctuation">:</span> cap<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">continue</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æˆ‘ä»¬çœ‹ä¸€ä¸‹paragraphå’Œä»¥åŠè¢«å¤„ç†çš„ç»“æœ
paragraphåœ¨blockå£°æ˜çš„æ—¶å€™è¢«å®šä¹‰äº†</p> <div class="language- extra-class"><pre class="language-text"><code>{ paragraph: /^([^\n]+(?:\n(?!hr|heading|lheading| {0,3}&gt;|&lt;\/?(?:tag)(?: +|\n|\/?&gt;)|&lt;(?:script|pre|style|!--))[^\n]+)*)/}
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>cap<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>  <span class="token string">&quot;Rendered by **marked**.&quot;</span>
cap<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>  <span class="token string">&quot;Rendered by **marked**.&quot;</span>
</code></pre></div><p>æ­¤æ—¶srcä¸ºç©ºå­—ç¬¦ä¸²,ç›´æ¥åœæ­¢,è·³å‡ºå¾ªç¯</p> <p>æ­¤æ—¶this.tokensä¸º</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>tokens <span class="token operator">=</span> <span class="token punctuation">[</span>
<span class="token punctuation">{</span>type<span class="token punctuation">:</span> <span class="token string">&quot;heading&quot;</span><span class="token punctuation">,</span> depth<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> text<span class="token punctuation">:</span> <span class="token string">&quot;Marked in the browser&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>type<span class="token punctuation">:</span> <span class="token string">&quot;paragraph&quot;</span><span class="token punctuation">,</span> text<span class="token punctuation">:</span> <span class="token string">&quot;Rendered by **marked**.&quot;</span><span class="token punctuation">]</span>
</code></pre></div><p>æ­¤æ—¶è¿”å›äº†æœ€åˆçš„Parser.parse(Lexer.lex(src, opt), opt);
è¯æ³•åˆ†æå™¨
Lexer.lex(src, opt)è°ƒç”¨çš„ç»“æœæ˜¯this.tokens
æ¥ä¸‹æ¥å°±è®©æˆ‘ä»¬åˆ†æParser.parseå§</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token comment">// Static Parse Method é™æ€æ–¹æ³•,ä¸ºä»€ä¹ˆä¸ç›´æ¥new,è¿˜éœ€è¦ç»•è¿™ä¹ˆä¸€ä¸ªå¤§åœˆå­</span>
Parser<span class="token punctuation">.</span><span class="token function-variable function">parse</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> parser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parser</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> parser<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Parse Loop
 */</span>
<span class="token comment">//1115</span>
Parser<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">parse</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">//this.optionsæ˜¯é»˜è®¤é…ç½®</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>inline <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InlineLexer</span><span class="token punctuation">(</span>src<span class="token punctuation">.</span>links<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// use an InlineLexer with a TextRenderer to extract pure text</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>inlineText <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InlineLexer</span><span class="token punctuation">(</span>
    src<span class="token punctuation">.</span>links<span class="token punctuation">,</span>
    <span class="token function">merge</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">,</span> <span class="token punctuation">{</span>renderer<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">TextRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>tokens <span class="token operator">=</span> src<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> out <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    out <span class="token operator">+=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">tok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> out<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//1138</span>
Parser<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">next</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// tokensè¢«åè½¬ç„¶åpopå³å§tokensçš„[0]èµ‹å€¼ç»™this.token</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>token <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>tokens<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>this.inlineå’Œ
this.inlineText
å¾ˆç›¸ä¼¼éƒ½æ˜¯InlineLexerçš„å®ä¾‹åŒ–,åŒºåˆ«åœ¨äºthis.inlineTextlinké‡Œæœ‰ä¸€å†™é…ç½®
// 1167</p> <p>tokåŸå‹å¯¹è±¡é‡Œæ˜¯å¯¹this.tokençš„å¤„ç†</p> <div class="language-js extra-class"><pre class="language-js"><code>Parser<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">tok</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'space'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">case</span> <span class="token string">'hr'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">hr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// æˆ‘ä»¬æ¥åˆ°headingè¿™é‡Œ,æ¥ä¸‹æ¥å°±æ˜¯åˆ†ææœ€é‡è¦çš„renderå¯¹è±¡äº†</span>
    <span class="token keyword">case</span> <span class="token string">'heading'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">heading</span><span class="token punctuation">(</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>inline<span class="token punctuation">.</span><span class="token function">output</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span>depth<span class="token punctuation">,</span>
        <span class="token function">unescape</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>inlineText<span class="token punctuation">.</span><span class="token function">output</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">case</span> <span class="token string">'code'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">code</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span>text<span class="token punctuation">,</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span>lang<span class="token punctuation">,</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span>escaped<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">case</span> <span class="token string">'table'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> header <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">,</span>
          body <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">,</span>
          i<span class="token punctuation">,</span>
          row<span class="token punctuation">,</span>
          cell<span class="token punctuation">,</span>
          j<span class="token punctuation">;</span>

      <span class="token comment">// header</span>
      cell <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span>header<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cell <span class="token operator">+=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">tablecell</span><span class="token punctuation">(</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>inline<span class="token punctuation">.</span><span class="token function">output</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span>header<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> header<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> align<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span>align<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">}</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      header <span class="token operator">+=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">tablerow</span><span class="token punctuation">(</span>cell<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span>cells<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        row <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span>cells<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

        cell <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> row<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          cell <span class="token operator">+=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">tablecell</span><span class="token punctuation">(</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>inline<span class="token punctuation">.</span><span class="token function">output</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span> header<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> align<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span>align<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token punctuation">}</span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        body <span class="token operator">+=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">tablerow</span><span class="token punctuation">(</span>cell<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">table</span><span class="token punctuation">(</span>header<span class="token punctuation">,</span> body<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">case</span> <span class="token string">'blockquote_start'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      body <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>

      <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>type <span class="token operator">!==</span> <span class="token string">'blockquote_end'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        body <span class="token operator">+=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">tok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">blockquote</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">case</span> <span class="token string">'list_start'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      body <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> ordered <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span>ordered<span class="token punctuation">,</span>
          start <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span>start<span class="token punctuation">;</span>

      <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>type <span class="token operator">!==</span> <span class="token string">'list_end'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        body <span class="token operator">+=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">tok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span>body<span class="token punctuation">,</span> ordered<span class="token punctuation">,</span> start<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">case</span> <span class="token string">'list_item_start'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      body <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> loose <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span>loose<span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span>task<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        body <span class="token operator">+=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">checkbox</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span>checked<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>type <span class="token operator">!==</span> <span class="token string">'list_item_end'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        body <span class="token operator">+=</span> <span class="token operator">!</span>loose <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'text'</span>
          <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">parseText</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">tok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">listitem</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">case</span> <span class="token string">'html'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// TODO parse inline content if parameter markdown=1</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">case</span> <span class="token string">'paragraph'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
     <span class="token comment">//this.inline.outputæŠŠ**marked**å¤„ç†æˆ&lt;strong&gt;marked&lt;/strong&gt;</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">paragraph</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>inline<span class="token punctuation">.</span><span class="token function">output</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">case</span> <span class="token string">'text'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">paragraph</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">parseText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// this.inline.outputæŠŠ**marked**å¤„ç†æˆ&lt;strong&gt;marked&lt;/strong&gt;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">paragraph</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>inline<span class="token punctuation">.</span><span class="token function">output</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * Static Lexing/Compiling Method
 */</span>
InlineLexer<span class="token punctuation">.</span><span class="token function-variable function">output</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> links<span class="token punctuation">,</span> options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> inline <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InlineLexer</span><span class="token punctuation">(</span>links<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> inline<span class="token punctuation">.</span><span class="token function">output</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
outputå¯¹è±¡é‡ŒåŒ¹é…åˆ°strong<span class="token punctuation">,</span>è°ƒç”¨renderer<span class="token punctuation">.</span>strong
<span class="token comment">// strong</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>cap <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>rules<span class="token punctuation">.</span>strong<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  src <span class="token operator">=</span> src<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>cap<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
  out <span class="token operator">+=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">strong</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">output</span><span class="token punctuation">(</span>cap<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">||</span> cap<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">||</span> cap<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">||</span> cap<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">continue</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// span level renderer</span>
Renderer<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">strong</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">'&lt;strong&gt;'</span> <span class="token operator">+</span> text <span class="token operator">+</span> <span class="token string">'&lt;/strong&gt;'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

    
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code> <span class="token comment">// 1574</span>
 renderer<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Renderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 marked<span class="token punctuation">.</span>Renderer <span class="token operator">=</span> Renderer<span class="token punctuation">;</span>
 <span class="token comment">// 911</span>
 <span class="token keyword">function</span> <span class="token function">Renderer</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> options <span class="token operator">||</span> marked<span class="token punctuation">.</span>defaults<span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 <span class="token comment">// 946</span>
 Renderer<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">heading</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> level<span class="token punctuation">,</span> raw<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// å¦‚æœé…ç½®ä¸­å°±idå°±è¿”å›å¸¦æœ‰id</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>headerIds<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'&lt;h'</span>
      <span class="token operator">+</span> level
      <span class="token operator">+</span> <span class="token string">' id=&quot;'</span>
      <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>headerPrefix
      <span class="token operator">+</span> raw<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/[^\w]+/g</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">)</span>
      <span class="token operator">+</span> <span class="token string">'&quot;&gt;'</span>
      <span class="token operator">+</span> text
      <span class="token operator">+</span> <span class="token string">'&lt;/h'</span>
      <span class="token operator">+</span> level
      <span class="token operator">+</span> <span class="token string">'&gt;\n'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ignore IDs</span>
  æ²¡æœ‰idå°±ç›´æ¥è¿”å›æ ‡ç­¾åŠ çº¹æ¿
  <span class="token keyword">return</span> <span class="token string">'&lt;h'</span> <span class="token operator">+</span> level <span class="token operator">+</span> <span class="token string">'&gt;'</span> <span class="token operator">+</span> text <span class="token operator">+</span> <span class="token string">'&lt;/h'</span> <span class="token operator">+</span> level <span class="token operator">+</span> <span class="token string">'&gt;\n'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// åŒç†</span>

<span class="token comment">// paragraphå¯¹this.tokenè¯´[2]åšäº†å¤„ç†</span>
Renderer<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">paragraph</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">'&lt;p&gt;'</span> <span class="token operator">+</span> text <span class="token operator">+</span> <span class="token string">'&lt;/p&gt;\n'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>headingæ¥å—ä¸‰ä¸ªå‚æ•°textæ˜¯æ–‡æœ¬å†…å®¹,levelæ˜¯headingçš„çº§åˆ« 1å°±æ˜¯H1,2å°±æ˜¯H2,rawç›®å‰æ˜¯å’Œlevelæ˜¯ä¸€æ ·çš„
ç»è¿‡ä¸¤è½®å¤„ç†
æ­¤æ—¶æˆ‘ä»¬çš„outå·²ç»æœ‰äº†ç»“æœ</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token operator">&lt;</span>h1 id<span class="token operator">=</span><span class="token string">&quot;marked-in-the-browser&quot;</span><span class="token operator">&gt;</span>Marked <span class="token keyword">in</span> the browser<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>Rendered by <span class="token operator">&lt;</span>strong<span class="token operator">&gt;</span>marked<span class="token operator">&lt;</span><span class="token operator">/</span>strong<span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
</code></pre></div><p>document.getElementById('content').innerHTML =marked('# Marked in the browser\n\nRendered by <strong>marked</strong>.');
å°±è¿™æ ·è¢«æ¸²æŸ“äº†.
è¿™ä¸ªå®ä¾‹å°±åˆ†æå®Œæ¯•äº†,å½“ç„¶é‡Œé¢è¿˜æœ‰å…¶ä»–çš„ç»†èŠ‚,æœ‰å…´è¶£çš„å¯ä»¥ä»”ç»†çœ‹çœ‹,æ¯”å¦‚ä»€ä¹ˆæ—¶å€™ä¼šå¸¦æœ‰idç­‰ç­‰
æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹marked.jsæ˜¯å¦‚ä½•å¤„ç†çš„
æœ€é‡è¦çš„å°±æ˜¯</p> <ol><li>å…ˆæ˜¯æ­£åˆ™,æŠŠç¬¦å·åŒ¹é…å‡ºæ¥,#æ˜¯heading,ç„¶åæ¨å…¥this.tokensæ•°ç»„é‡Œ
æ¯å¤„ç†ä¸€è¡Œ,æ¨å…¥ä¸€ä¸ª(æŠŠscré€šè¿‡æ­£åˆ™å¤„ç†æˆthis.tokens))</li> <li>å¯¹this.tokensçš„å¤„ç†,é€šè¿‡æ­£åˆ™åŒ¹é…åˆ°å°±è°ƒç”¨ç›¸åº”çš„renderå¯¹è±¡é‡Œçš„æ–¹æ³•</li> <li>renderå¯¹è±¡å¯¹è¾“å…¥çš„tokensè¿›è¡Œå¤„ç†è¿”å›outå¤„ç†ç»“æœ</li></ol> <p>ä¼˜ç‚¹</p> <ol><li>æ¯ä¸€ä¸ªåŠŸèƒ½éƒ½åˆ†åˆ«å®šä¹‰ä¸€ä¸ªå‡½æ•° renderæ¸²æŸ“ç”¨, laxerè¯æ³•è§£æç”¨,å®ç°å®šä¹‰å¥½å„ç§æ­£åˆ™,å¾ˆæ¸…æ™°æ˜æ˜äº†</li> <li>é™æ€æ–¹æ³•çš„ä½¿ç”¨</li></ol> <p>æ€»ä¹‹çœ‹ç€å¾ˆå¤æ‚,å½“ä½ åˆ†æå®Œä¸€ä¸ªæˆ–è€…å†™å®Œä¸€ä¸ªæ˜ç™½ä¸€ä¸ªå,å…¶ä»–çš„éƒ½æ˜¯ä¾æ­¤ç±»æ¨,å°±æ˜¯åŠ›æ°”æ´»äº†</p> <p>ä»¥ä¸Š</p></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">12/29/2018, 4:25:44 PM</span></div></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/blog/source/react-beauty-highcharts.html">
          ç¾åŒ–HighChartsæ’ä»¶  react-beauty-highcharts
        </a>
        â†’
      </span></p></div> </div> <!----></div></div>
    <script src="/blog/assets/js/24.cc9b4c20.js" defer></script><script src="/blog/assets/js/app.b8f6f876.js" defer></script>
  </body>
</html>
